$mainTsPath = "c:\personal-proyects\queee\main.ts"
$mainTsContent = Get-Content -Path $mainTsPath -Raw

$functionToAdd = @'
function chrome_basico () {
    for (let value2 of tiles.getTilesByType(assets.tile`myTile5`)) {
        chrome_intro = sprites.create(img`
            ......................................................................
                        ......................................................................
                        ......................................................................
                        ......................................................................
                        ...............fff....................................................
                        .............ffff5fffffffffff.........................................
                        ..........ffff77f555555555555fffffffffffffff..........................
                        .........ff5ff77f555555555555555555555555555fffff.....................
                        ........ff5555f7f55555555555555555555555555555555ffff.................
                        ........f55555f7fff5555555555555555555555555555555555fff..............
                        ........f55555f777ff555555555555555555555555555555555555ff............
                        .......f555555f77777ff555555555555555555555555555555555555ff..........
                        .......f555555f7777777f5555555555555555555555555555555555555ff........
                        ......f555555f77777777ff5555555555555555555555555555555555555ff.......
                        ......f555555f777777777f555555555555555555555555555555555555555ff.....
                        ......f555555ff77777777f55555555555555555555555ffffffffffffffffff....
        `, SpriteKind.chrome)
        tiles.placeOnTile(chrome_intro, value2)
        tiles.setTileAt(value2, assets.tile`transparency16`)
        statusbar = statusbars.create(60, 4, StatusBarKind.vida_chrome)
        statusbar.attachToSprite(chrome_intro, 5, 0)
        statusbar.setColor(5, 7, 8)
        statusbar.max = 10
        statusbar.value = 10
        statusbar.setStatusBarFlag(StatusBarFlag.SmoothTransition, true)
    }
}

'@

$pattern = "function pez_espada \(\) \{[\s\S]*?\}"
$replacement = "function pez_espada () {" + $mainTsContent.Substring($mainTsContent.IndexOf("function pez_espada () {") + 21, $mainTsContent.IndexOf("}", $mainTsContent.IndexOf("function pez_espada () {")) - $mainTsContent.IndexOf("function pez_espada () {") - 21 + 1) + "`n`n" + $functionToAdd

$updatedContent = $mainTsContent -replace $pattern, $replacement

Set-Content -Path $mainTsPath -Value $updatedContent

Write-Host "Función chrome_basico() añadida correctamente a main.ts"
